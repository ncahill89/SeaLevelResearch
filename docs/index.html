<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.33">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>ExStrEAms: Extreme Sea Level and Surge Analysis Resources – ExStrEAms</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-ea385d0e468b0dd5ea5bf0780b1290d9.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-84a1efca214e6a1eed6739f33f9111cb.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="floating nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">ExStrEAms</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="./index.html" aria-current="page"> 
<span class="menu-text">Home</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#interactive-tools" id="toc-interactive-tools" class="nav-link active" data-scroll-target="#interactive-tools">Interactive Tools</a>
  <ul class="collapse">
  <li><a href="#ireland-surge-analysis-tool" id="toc-ireland-surge-analysis-tool" class="nav-link" data-scroll-target="#ireland-surge-analysis-tool">Ireland Surge Analysis Tool</a></li>
  <li><a href="#geslar-data-viewer-analysis-tool" id="toc-geslar-data-viewer-analysis-tool" class="nav-link" data-scroll-target="#geslar-data-viewer-analysis-tool">geslaR Data Viewer &amp; Analysis Tool</a></li>
  </ul></li>
  <li><a href="#r-packages" id="toc-r-packages" class="nav-link" data-scroll-target="#r-packages">R Packages</a>
  <ul class="collapse">
  <li><a href="#reslr-relative-sea-level-modelling" id="toc-reslr-relative-sea-level-modelling" class="nav-link" data-scroll-target="#reslr-relative-sea-level-modelling"><code>reslr</code> – Relative Sea Level Modelling</a></li>
  <li><a href="#geslar-gesla-tidal-data-tools" id="toc-geslar-gesla-tidal-data-tools" class="nav-link" data-scroll-target="#geslar-gesla-tidal-data-tools"><code>geslaR</code> – GESLA Tidal Data Tools</a></li>
  </ul></li>
  <li><a href="#key-publications" id="toc-key-publications" class="nav-link" data-scroll-target="#key-publications">Key Publications</a>
  <ul class="collapse">
  <li><a href="#reslr-an-r-package-for-relative-sea-level-modelling" id="toc-reslr-an-r-package-for-relative-sea-level-modelling" class="nav-link" data-scroll-target="#reslr-an-r-package-for-relative-sea-level-modelling">reslr: An R Package for Relative Sea Level Modelling</a></li>
  <li><a href="#a-noisy-input-generalized-additive-model-for-relative-sea-level-change" id="toc-a-noisy-input-generalized-additive-model-for-relative-sea-level-change" class="nav-link" data-scroll-target="#a-noisy-input-generalized-additive-model-for-relative-sea-level-change">A noisy-input generalized additive model for relative sea-level change</a></li>
  <li><a href="#two-centuries-of-relative-sea-level-rise-in-dublin-ireland" id="toc-two-centuries-of-relative-sea-level-rise-in-dublin-ireland" class="nav-link" data-scroll-target="#two-centuries-of-relative-sea-level-rise-in-dublin-ireland">Two Centuries of Relative Sea-Level Rise in Dublin, Ireland</a></li>
  <li><a href="#global-survey-shows-planners-use-widely-varying-sea-level-rise-projections-for-coastal-adaptation" id="toc-global-survey-shows-planners-use-widely-varying-sea-level-rise-projections-for-coastal-adaptation" class="nav-link" data-scroll-target="#global-survey-shows-planners-use-widely-varying-sea-level-rise-projections-for-coastal-adaptation">Global survey shows planners use widely varying sea-level rise projections for coastal adaptation</a></li>
  <li><a href="#a-bayesian-time-series-model-for-reconstructing-hydroclimate" id="toc-a-bayesian-time-series-model-for-reconstructing-hydroclimate" class="nav-link" data-scroll-target="#a-bayesian-time-series-model-for-reconstructing-hydroclimate">A Bayesian time series model for reconstructing hydroclimate</a></li>
  </ul></li>
  <li><a href="#preprints-under-reveiw" id="toc-preprints-under-reveiw" class="nav-link" data-scroll-target="#preprints-under-reveiw">Preprints (under reveiw)</a>
  <ul class="collapse">
  <li><a href="#a-scalable-bayesian-spatiotemporal-model-for-water-level-predictions-using-a-nearest-neighbor-gaussian-process-approach" id="toc-a-scalable-bayesian-spatiotemporal-model-for-water-level-predictions-using-a-nearest-neighbor-gaussian-process-approach" class="nav-link" data-scroll-target="#a-scalable-bayesian-spatiotemporal-model-for-water-level-predictions-using-a-nearest-neighbor-gaussian-process-approach">A scalable Bayesian spatiotemporal model for water level predictions using a nearest neighbor Gaussian process approach</a></li>
  <li><a href="#a-bayesian-hierarchical-spatio-temporal-model-with-physical-barriers-for-extreme-sea-level-prediction-in-ireland" id="toc-a-bayesian-hierarchical-spatio-temporal-model-with-physical-barriers-for-extreme-sea-level-prediction-in-ireland" class="nav-link" data-scroll-target="#a-bayesian-hierarchical-spatio-temporal-model-with-physical-barriers-for-extreme-sea-level-prediction-in-ireland">A Bayesian hierarchical spatio-temporal model with physical barriers for extreme sea-level prediction in Ireland</a></li>
  </ul></li>
  <li><a href="#grant-acknowledgement" id="toc-grant-acknowledgement" class="nav-link" data-scroll-target="#grant-acknowledgement">Grant Acknowledgement</a></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content column-page-right" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">ExStrEAms: Extreme Sea Level and Surge Analysis Resources</h1>
</div>



<div class="quarto-title-meta column-page-right">

    
  
    
  </div>
  


</header>


<p><strong>ExStrEAms</strong> is a curated collection of tools and interactive applications developed as part of ongoing research into extreme sea level and storm surge events, with a focus on Ireland and the surrounding coastal regions. These resources are intended to support climate resilience and coastal risk assessments.</p>
<section id="interactive-tools" class="level2">
<h2 class="anchored" data-anchor-id="interactive-tools">Interactive Tools</h2>
<section id="ireland-surge-analysis-tool" class="level3">
<h3 class="anchored" data-anchor-id="ireland-surge-analysis-tool"><a href="https://sealevelresearch.shinyapps.io/IrelandSurge/">Ireland Surge Analysis Tool</a></h3>
<p>This interactive app enables users to:</p>
<ul>
<li><p>Visualize sea level surges across Irish coastal locations.</p></li>
<li><p>Apply statistical methods for extreme value analysis using the <code>extRemes</code> R package.</p></li>
<li><p>Estimate return levels and exceedance frequencies.</p></li>
</ul>
<p><img src="images/Screenshot 2025-06-13 at 21.09.14.png" class="img-fluid"></p>
</section>
<section id="geslar-data-viewer-analysis-tool" class="level3">
<h3 class="anchored" data-anchor-id="geslar-data-viewer-analysis-tool"><a href="https://sealevelresearch.shinyapps.io/geslaR-app/">geslaR Data Viewer &amp; Analysis Tool</a></h3>
<p>An interactive app built on the <a href="https://eireextremes.github.io/geslaR/"><code>geslaR</code></a> package for exploring and analyzing the GESLA dataset.</p>
<p>Key features:</p>
<ul>
<li><p>Visual exploration of tide gauge records from the Global Extreme Sea Level Analysis (GESLA) project.</p></li>
<li><p>Filtering by station metadata and data quality indicators.</p></li>
<li><p>Download location specific data for further analysis.</p></li>
</ul>
<p><img src="images/Screenshot 2025-06-13 at 21.20.41.png" class="img-fluid"></p>
<hr>
</section>
</section>
<section id="r-packages" class="level2">
<h2 class="anchored" data-anchor-id="r-packages">R Packages</h2>
<section id="reslr-relative-sea-level-modelling" class="level3">
<h3 class="anchored" data-anchor-id="reslr-relative-sea-level-modelling"><a href="https://maeveupton.github.io/reslr/"><code>reslr</code></a> – Relative Sea Level Modelling</h3>
<p><strong>Author:</strong> Maeve Upton<br>
The <code>reslr</code> package provides functions and tools for reconstructing and modeling <strong>relative sea level change</strong> using flexible statistical models.</p>
<ul>
<li>Tools for Gaussian Process regression and temporal uncertainty.</li>
<li>User-friendly functions for coastal paleoclimate studies.</li>
</ul>
<p>➡️ Visit the <a href="https://maeveupton.github.io/reslr/"><code>reslr</code> package website</a></p>
<hr>
</section>
<section id="geslar-gesla-tidal-data-tools" class="level3">
<h3 class="anchored" data-anchor-id="geslar-gesla-tidal-data-tools"><a href="https://eireextremes.github.io/geslaR/"><code>geslaR</code></a> – GESLA Tidal Data Tools</h3>
<p><strong>Author:</strong> Fernando Mayer<br>
The <code>geslaR</code> package provides streamlined access and tools to work with GESLA (Global Extreme Sea Level Analysis) data.</p>
<ul>
<li>Easily download and clean GESLA files.</li>
<li>Visualize and prepare data for extreme analysis.</li>
</ul>
<p>➡️ Visit the <a href="https://eireextremes.github.io/geslaR/"><code>geslaR</code> package site</a></p>
<hr>
</section>
</section>
<section id="key-publications" class="level2">
<h2 class="anchored" data-anchor-id="key-publications">Key Publications</h2>
<section id="reslr-an-r-package-for-relative-sea-level-modelling" class="level3">
<h3 class="anchored" data-anchor-id="reslr-an-r-package-for-relative-sea-level-modelling">reslr: An R Package for Relative Sea Level Modelling</h3>
<ul>
<li><p><strong>Citation:</strong> Maeve Upton, Andrew Parnell, Niamh Cahill, “reslr: An R Package for Relative Sea Level Modelling”, The R Journal, 2025</p></li>
<li><p><strong>Summary:</strong> An R package to perform Bayesian modelling of relative sea level data. Includes a variety of different statistical models previously proposed in the literature, with a unifying framework for loading data, fitting models, and summarising the results.</p></li>
</ul>
<p>Check out the <a href="https://journal.r-project.org/articles/RJ-2024-018/">paper</a></p>
<hr>
</section>
<section id="a-noisy-input-generalized-additive-model-for-relative-sea-level-change" class="level3">
<h3 class="anchored" data-anchor-id="a-noisy-input-generalized-additive-model-for-relative-sea-level-change">A noisy-input generalized additive model for relative sea-level change</h3>
<ul>
<li><p><strong>Citation:</strong> Maeve Upton, Andrew Parnell, Andrew Kemp, Erica Ashe, Gerard McCarthy, Niamh Cahill, A noisy-input generalized additive model for relative sea-level change along the Atlantic coast of North America, Journal of the Royal Statistical Society Series C: Applied Statistics, Volume 74, Issue 1, January 2025, Pages 34–82, https://doi.org/10.1093/jrsssc/qlae044</p></li>
<li><p><strong>Summary:</strong> Introduces a <strong>Bayesian spatial–temporal generalized additive model</strong> designed to analyze regional relative sea-level (RSL) trends with noisy inputs and robust uncertainty estimation.</p></li>
</ul>
<p>Check out the <a href="https://academic.oup.com/jrsssc/article/74/1/34/7756353#499919970">paper</a></p>
<hr>
</section>
<section id="two-centuries-of-relative-sea-level-rise-in-dublin-ireland" class="level3">
<h3 class="anchored" data-anchor-id="two-centuries-of-relative-sea-level-rise-in-dublin-ireland">Two Centuries of Relative Sea-Level Rise in Dublin, Ireland</h3>
<ul>
<li><p><strong>Citation:</strong> Roseby, Z.A., Southall, K., Alvarez-Agoues, F., Cahill, N., McCarthy, G.D. and Edwards, R.J. (2023) ‘Two Centuries of Relative Sea-Level Rise in Dublin, Ireland, Reconstructed by Geological Tide Gauge’, Open Quaternary, 9(1), p.&nbsp;3. Available at: https://doi.org/10.5334/oq.121.</p></li>
<li><p><strong>Summary:</strong> We demonstrate the utility and reproducibility of the saltmarsh foraminifera-based ‘geological tide gauge’ (GTG) approach by developing two independent records of relative sea-level (RSL) change for Dublin, Ireland. Our records, recovered from two different saltmarshes, indicate that RSL rose at a century-scale rate of 1.5 ± 0.9 mm yr–1 over the last 200 years.</p></li>
</ul>
<p>Check out the <a href="https://openquaternary.com/articles/10.5334/oq.121">paper</a></p>
<hr>
</section>
<section id="global-survey-shows-planners-use-widely-varying-sea-level-rise-projections-for-coastal-adaptation" class="level3">
<h3 class="anchored" data-anchor-id="global-survey-shows-planners-use-widely-varying-sea-level-rise-projections-for-coastal-adaptation">Global survey shows planners use widely varying sea-level rise projections for coastal adaptation</h3>
<ul>
<li><p><strong>Citation:</strong> Hirschfeld, D., Behar, D., Nicholls, R.J., Cahill, N. et al.&nbsp;Global survey shows planners use widely varying sea-level rise projections for coastal adaptation. Commun Earth Environ 4, 102 (2023). https://doi.org/10.1038/s43247-023-00703-x</p></li>
<li><p><strong>Summary:</strong> Provides new insights about current planning practices and can inform important ongoing efforts on the application of sea level science that is essential to the promotion of effective adaptation.</p></li>
</ul>
<p>Check out the <a href="https://www.nature.com/articles/s43247-023-00703-x">paper</a></p>
<hr>
</section>
<section id="a-bayesian-time-series-model-for-reconstructing-hydroclimate" class="level3">
<h3 class="anchored" data-anchor-id="a-bayesian-time-series-model-for-reconstructing-hydroclimate">A Bayesian time series model for reconstructing hydroclimate</h3>
<ul>
<li><p><strong>Citation:</strong> Cahill, N., Croke, J., Campbell, M., Hughes, K., Vitkovsky, J., Kilgallen, J. E., &amp; Parnell, A. (2023). A Bayesian time series model for reconstructing hydroclimate from multiple proxies. Environmetrics, 34(4), e2786. https://doi.org/10.1002/env.2786</p></li>
<li><p><strong>Summary:</strong> A Bayesian model which produces probabilistic reconstructions of hydroclimatic variability. The model provides a standardized approach to hydroclimate reconstruction using multiple palaeoclimate proxy records derived from natural archives such as speleothems, ice cores and tree rings. The method combines time-series modeling with inverse prediction to quantify the relationships between a given hydroclimate index and relevant proxies over an instrumental period and subsequently reconstruct the hydroclimate back through time.</p></li>
</ul>
<p>Check out the <a href="https://onlinelibrary.wiley.com/doi/full/10.1002/env.2786">paper</a></p>
<hr>
</section>
</section>
<section id="preprints-under-reveiw" class="level2">
<h2 class="anchored" data-anchor-id="preprints-under-reveiw">Preprints (under reveiw)</h2>
<section id="a-scalable-bayesian-spatiotemporal-model-for-water-level-predictions-using-a-nearest-neighbor-gaussian-process-approach" class="level3">
<h3 class="anchored" data-anchor-id="a-scalable-bayesian-spatiotemporal-model-for-water-level-predictions-using-a-nearest-neighbor-gaussian-process-approach">A scalable Bayesian spatiotemporal model for water level predictions using a nearest neighbor Gaussian process approach</h3>
<ul>
<li><p><strong>Citation:</strong> Nagahama, V. H., Sweeney, J., &amp; Cahill, N. (2025). A scalable Bayesian spatiotemporal model for water level predictions using a nearest neighbor Gaussian process approach (Version 2). arXiv. https://doi.org/10.48550/arXiv.2412.06934</p></li>
<li><p><strong>Summary:</strong> A scalable Bayesian model for predicting river water levels across space and time. The model enables accurate and efficient forecasting by leveraging a Nearest Neighbor Gaussian Process (NNGP) framework, designed to handle large datasets. It incorporates spatial and temporal structure while addressing the computational challenges of standard Gaussian Processes. The method applies to daily river level observations from multiple monitoring stations, providing both future predictions and spatial interpolations at unmeasured locations. Uncertainty is quantified through the Bayesian framework.</p></li>
</ul>
<p>Check out the <a href="https://arxiv.org/abs/2412.06934">paper</a></p>
</section>
<section id="a-bayesian-hierarchical-spatio-temporal-model-with-physical-barriers-for-extreme-sea-level-prediction-in-ireland" class="level3">
<h3 class="anchored" data-anchor-id="a-bayesian-hierarchical-spatio-temporal-model-with-physical-barriers-for-extreme-sea-level-prediction-in-ireland">A Bayesian hierarchical spatio-temporal model with physical barriers for extreme sea-level prediction in Ireland</h3>
<ul>
<li><p><strong>Citation:</strong> Mayer, F. P. &amp; Cahill, N. (2025). A Bayesian hierarchical spatio-temporal model with physical barriers for extreme sea-level prediction in Ireland. Environmetrics. <em>Under review</em>.</p></li>
<li><p><strong>Summary:</strong> This paper develops a Bayesian hierarchical spatio-temporal model to estimate extreme sea levels in Ireland, using data from 26 Irish tide gauges and 21 from the West coast of Great Britain. Annual maxima (1961–2021) are modelled with the blended Generalised Extreme Value (bGEV) distribution, incorporating spatial dependence via a Matérn correlation and coastline barriers through the SPDE approach, while temporal trends are captured with a random walk. Predictions at ungauged sites are made using a coastal mesh. Results show rising extreme sea levels, with the East coast most at risk. The model better reflects coastal processes, supporting flood risk management and policymaking.</p></li>
</ul>
</section>
</section>
<section id="grant-acknowledgement" class="level2">
<h2 class="anchored" data-anchor-id="grant-acknowledgement">Grant Acknowledgement</h2>
<p>This work has emanated from research conducted with the financial support of <strong>Taighde Éireann – Research Ireland</strong>, and co-funded by the <strong>Geological Survey Ireland (GSI)</strong>, under Grant Number <strong>20/FFP-P/8610</strong>.</p>
<hr>


</section>

</main> <!-- /main -->

<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
            // default icon
            link.classList.add("external");
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>